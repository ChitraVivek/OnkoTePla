<UserControl x:Class="bytePassion.OnkoTePla.Client.WPFVisualization.Views.AppointmentGrid"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:sampleData="clr-namespace:bytePassion.OnkoTePla.Client.WPFVisualization.SampleData"
             xmlns:behaviors="clr-namespace:bytePassion.OnkoTePla.Client.WPFVisualization.Behaviors"
             xmlns:converter="clr-namespace:bytePassion.OnkoTePla.Client.WPFVisualization.Converter"
             xmlns:views="clr-namespace:bytePassion.OnkoTePla.Client.WPFVisualization.Views"
             mc:Ignorable="d" 
             d:DesignHeight="700" d:DesignWidth="900">
	
	<d:UserControl.DataContext>
		<sampleData:AppointmentGridViewModelSampleData/>
	</d:UserControl.DataContext>
	
	<UserControl.Resources>
		<converter:AddOffsetToDoubleConverter x:Key="AddOffsetToDouble"/>
	</UserControl.Resources>

	<Grid Background="White">
		<Grid.RowDefinitions>
			<RowDefinition Height="50"/>
			<RowDefinition/>
		</Grid.RowDefinitions>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="150"/>
			<ColumnDefinition/>
		</Grid.ColumnDefinitions>				
		
		<Border Grid.Row="0" Grid.Column="1" Grid.RowSpan="2">
			<i:Interaction.Behaviors>
				<behaviors:SizeReportingBehavior CurrentWidth= "{Binding CurrentGridWidth, 
																		 Mode=OneWayToSource, 
																		 UpdateSourceTrigger=PropertyChanged}"
												 CurrentHeight="{Binding CurrentGridHeight,
																		 Mode=OneWayToSource,
																		 UpdateSourceTrigger=PropertyChanged}"/>
			</i:Interaction.Behaviors>
		</Border>
		

		<Button Grid.Column="0"
				Grid.Row="0"
				Margin="10,5"
				Click="ButtonBase_OnClick">
			<TextBlock>
				TestLoad (3.7.2015)<LineBreak/>
				examplePractice1
			</TextBlock>
		</Button>

		
		<ItemsControl Grid.Row="0" Grid.Column="1" ItemsSource="{Binding TimeSlotLabels}">
			<!-- ReSharper disable Xaml.BindingWithContextNotResolved -->
			<ItemsControl.ItemContainerStyle>
				<Style>
					<Setter Property="Canvas.Left" Value="{Binding XCoord, Converter={StaticResource AddOffsetToDouble}, ConverterParameter=-8}"/>					
					<Setter Property="Canvas.Top"  Value="{Binding YCoord}"/>					
				</Style>
			</ItemsControl.ItemContainerStyle>
			<!-- ReSharper restore Xaml.BindingWithContextNotResolved -->
			
			<ItemsControl.ItemTemplate>
				<DataTemplate>
					<TextBlock Text="{Binding Caption}"/>
				</DataTemplate>
			</ItemsControl.ItemTemplate>
			
			<ItemsControl.ItemsPanel>
				<ItemsPanelTemplate>
					<Canvas/>											
				</ItemsPanelTemplate>
			</ItemsControl.ItemsPanel>
			
		</ItemsControl>

		<ItemsControl Grid.Row="0" Grid.Column="1" Grid.RowSpan="2" ItemsSource="{Binding TimeSlotLines}">

			<ItemsControl.ItemTemplate>
				<DataTemplate>
					<Line Stroke="Black"
						  StrokeThickness="1"
						  StrokeDashArray="3,1"
						  X1="{Binding XCoord}"
						  X2="{Binding XCoord}"
						  Y1="{Binding YCoordTop}"
						  Y2="{Binding YCoordBottom}"/>
				</DataTemplate>
			</ItemsControl.ItemTemplate>

			<ItemsControl.ItemsPanel>
				<ItemsPanelTemplate>
					<Canvas/>
				</ItemsPanelTemplate>
			</ItemsControl.ItemsPanel>
		</ItemsControl>

		<ScrollViewer Grid.Row="1" 
					  Grid.Column="0"
					  Grid.ColumnSpan="2"
					  Margin="0,15,0,0"
					  HorizontalScrollBarVisibility="Disabled"
					  VerticalScrollBarVisibility="Hidden">
		
			<ItemsControl ItemsSource="{Binding TherapyPlaceRows}">
			
				<ItemsControl.ItemsPanel>
					<ItemsPanelTemplate>
						<StackPanel/>
					</ItemsPanelTemplate>
				</ItemsControl.ItemsPanel>
			
				<ItemsControl.ItemTemplate>
					<DataTemplate>
						<views:TherapyPlaceRowView Margin="0,3"/>
					</DataTemplate>
				</ItemsControl.ItemTemplate>
			
			</ItemsControl>
		</ScrollViewer>
	</Grid>
</UserControl>
